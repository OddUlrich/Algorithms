# 堆与优先级队列

数据结构堆主要包括最大堆和最小堆两种。最大堆又称大根堆，最小堆又称小根堆。顾名思义，在最大堆的每一个子树当中，根结点的值都比其子树结点的值大或者相等，即不小于子树结点的值。最小堆亦有相应的性质。

堆的结构是基于一棵完全二叉树的，因此一个具有 n 个元素的堆，其高度为 lg n。因此，堆结构上的一些基本操作的运行时间至多都与其高度成正比，为 O(lg n)。

* O(n) - 构建堆（在线性时间内，将无序数组组建成一个堆）
* O(lg n) - 保持堆性质、插入、删除、获取堆顶值
* O(n lg n) - 排序（执行 n 次堆性质的维护）



因为堆是一个**完全二叉树**，所以可以用数组来表示一个堆，且数组索引从上往下，从左往右依次递增。所以元素的索引就会有以下性质：若某个子树的根结点索引为 i，那么

* 左子结点的索引为 2i；
* 右子结点的索引为 2i + 1。





## 最大堆（大根堆）

在堆排序算法中，我们通常使用的是最大堆。或者求一个序列的前 k 小值、第 k 小值，也能使用最大堆。



## 最小堆（小根堆）

最小堆通常在构造优先队列时使用。或者求一个序列的前 k 大值、第 k 大值，也能使用最小堆。



插入：在数组末尾插入新元素，然后在树的结构上逐层向上交换，直至满足小根堆的性质。

删除：抛出堆顶元素，用数组末尾的元素替代，然后逐级往下与较小的子结点比较，直至不能交换为止。





## 优先级队列

与堆类似，队列也分两种：最大优先级队列和最小优先级队列。优先级队列可以通过堆来实现。

最大优先级队列的一个应用是在一台分时计算机上进行作业调度。这种队列对要执行的各作业及他们之间的相对有限关系加以记录。当一个作业完成或者被中断时，马上就从等待的作业中，选择出具有最高优先级的作业。在任何时候，一个新的作业都能插入到队列中去。

最小优先级队列可用于基于事件驱动的模拟器。在这种应用中，队列中的各项是要按照时间顺序来模拟时间的发生。