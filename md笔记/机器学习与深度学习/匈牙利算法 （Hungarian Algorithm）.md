# 匈牙利算法 （Hungarian Algorithm）

匈牙利算法时一种在多项式时间内求解任务分配问题的组合优化算法。它常常与 KM 算法（Kuhn-Munkres Algorithm）一起讨论，用于**多目标跟踪**的场景中，都是用来解决多目标跟踪中的数据关联问题。



## 二分图（二部图）

匈牙利算法与 KM 算法都是为了求解二分图的最大匹配问题而产生的。

二分图是指一个把点集分成两组，分别为 U 和 V。其中，U 上的点不能相互连通，只能连去 V 中的点；同理，V 中的点不能相互连通，只能连去 U 中的点。

将二分图与视频连续帧中的所有检测框，前一帧与后一帧的所有检测框的集合可以分别称为 U 和 V。同一帧的不同检测框不会为同一个目标，所以不需要相互关联；相邻两帧的检测框需要互相连通，最终将相邻两帧的检测框尽量完美地两两匹配起来。



## 具体实现

在执行匈牙利算法之前，我们需要先产生 U 和 V 之间最有可能产生的关联关系。由于算法并不是绝对理想的，所以并不能保证每张图都有一对一的匹配，有时候会出现一对二甚至一对多，再甚至多对多的情况也时而发生。在这基础上，我们再通过匈牙利算法作出最佳匹配。

基本操作：（FIXME）

* 依次挑选 U 中的对象 u 与 V 中对象 v 进行匹配。
* （以下是递归过程）若 u 选中匹配的第一个对象已经被前面某个 u_old 匹配了，那就临时拆掉 u_old 的这条匹配。
* u_old 从下一个可选择对象 v 开始，重新进行匹配。
* 不存在匹配对象的，则放弃匹配。
* 完成以上递归过程，遍历所有 U 中对象后，算法流程结束。

## 分析与总结

实际上，匈牙利算法匹配出来的结果不一定是最优匹配，因为该算法将每个匹配对象的地位视为相同，因此匈牙利算法对候选匹配的准确度要求很高。在多目标跟踪问题中，也就是要求运动模型、外观模型等部件必须进行精准的预测，或者预设较高的阈值，只讲置信度较高的匹配关系送入匈牙利算法进行匹配，这样才能得到较好的结果。

同时，在多目标追踪问题里，每个匹配对象一般都有不同的权重，总会存在一个真实目标是我们想要找的最佳匹配，赋予这个目标更高的权重，才更符合真实情况，匹配的结果才更理想。



## KM 算法

KM算法解决的是**带权二分图**的最优匹配问题。





在引入了权重之后，匹配成功率能够大大提高。