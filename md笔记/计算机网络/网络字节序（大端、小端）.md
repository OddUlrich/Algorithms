# 网络字节序（大端、小端）

在进行网络通信时，我们所传输的数据流是字节流，对于一个多字节数值，在进行网络传输时，发送端和接收端如何确定当前字节是属于高位还是低位呢？

根据网络字节序的定义，接收端收到的第一个字节被当做**高位**看待。这就要求发送端发送的第一个字节应当是高位。

* **大端法**（Big-Endian）：高位字节排放在内存的**低地址端，即该值的起始位置**，低位字节排放在内存的高地址端。
* **小端法**（Little-Endian）：低位字节排放在内存的**低地址端，即该值的起始位置**，高位字节排放在内存的高地址端。

在发送端发送数据时，发送的第一个字节通常是该数据在内存中**起始地址**对应的字节。因此，多字节数值在发送前，在内存中数值应该以大端法存放，以保证第一个发送的字节被作为高位处理。对应的，接收端接收到数据后，要将数据相应转换，再以小端法存储到内存中。否则会影响本地读取内存时获得的值。

系统提供的转字节序函数有：

* htons()：将16位无符号整数从本地字节序转换成网络字节序
* htonl()：将32位无符号整数从本地字节序转换成网络字节序
* ntohs()：将16位无符号整数从网络字节序转换成本地字节序
* ntohl()：将32位无符号整数从网络字节序转换成本地字节序



这些转字节序函数通常是针对一般数据类型进行转序的。在网络通信时，IP 地址也是一个重要的数据，根据情况有时候也需要进行转序。另一个与 IP 地址的存储与发送相关的问题是，IP 地址的表示常常会在字符串形式与数字形式切换，因此系统也提供了一些常用的转换函数：

* inet_ntoa()：将 IPv4 地址从数字形式转化成字符串形式，不适用于 IPv6
* inet_aton()：将 IPv4 地址从字符串形式转化成数字形式，不适用于 IPv6
* inet_ntop()：将 IPv6 地址从数字形式转化成字符串形式，同样适用于 IPv4
* inet_pton()：将 IPv6 地址从数字形式转化成字符串形式，同样适用于 IPv4

